{
    "info": {
        "name": "API Gateway - Master Collection",
        "description": "Complete API collection for E-Commerce Platform through API Gateway. This is the master collection that routes requests to all microservices.",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
        "version": "1.0.0"
    },
    "variable": [
        {
            "key": "BASE_URL",
            "value": "http://localhost:4000",
            "type": "string"
        },
        {
            "key": "FIREBASE_ID_TOKEN",
            "value": "",
            "type": "string"
        },
        {
            "key": "USER_ID",
            "value": "",
            "type": "string"
        },
        {
            "key": "ORDER_ID",
            "value": "",
            "type": "string"
        },
        {
            "key": "PRODUCT_ID",
            "value": "1",
            "type": "string"
        }
    ],
    "auth": {
        "type": "bearer",
        "bearer": [
            {
                "key": "token",
                "value": "{{FIREBASE_ID_TOKEN}}",
                "type": "string"
            }
        ]
    },
    "item": [
        {
            "name": "Health Checks",
            "item": [
                {
                    "name": "API Gateway Health",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/health",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "health"
                            ]
                        },
                        "description": "Check if the API Gateway is healthy and running"
                    }
                }
            ]
        },
        {
            "name": "User Service",
            "item": [
                {
                    "name": "Register User",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200 || pm.response.code === 201) {",
                                    "    const jsonData = pm.response.json();",
                                    "    if (jsonData.idToken) {",
                                    "        pm.environment.set('FIREBASE_ID_TOKEN', jsonData.idToken);",
                                    "        pm.environment.set('USER_ID', jsonData.uid);",
                                    "        console.log('Token saved:', jsonData.idToken);",
                                    "    }",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"test@example.com\",\n  \"password\": \"Test123!\",\n  \"displayName\": \"Test User\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/api/users/register",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "users",
                                "register"
                            ]
                        },
                        "description": "Register a new user through the API Gateway"
                    }
                },
                {
                    "name": "Login User",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    const jsonData = pm.response.json();",
                                    "    if (jsonData.idToken) {",
                                    "        pm.environment.set('FIREBASE_ID_TOKEN', jsonData.idToken);",
                                    "        pm.environment.set('USER_ID', jsonData.uid);",
                                    "        console.log('Token saved:', jsonData.idToken);",
                                    "    }",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"test@example.com\",\n  \"password\": \"Test123!\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/api/users/login",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "users",
                                "login"
                            ]
                        },
                        "description": "Login an existing user through the API Gateway"
                    }
                },
                {
                    "name": "Get User Profile",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/users/profile",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "users",
                                "profile"
                            ]
                        },
                        "description": "Get the authenticated user's profile"
                    }
                },
                {
                    "name": "Update User Profile",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"displayName\": \"Updated Name\",\n  \"phoneNumber\": \"+1234567890\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/api/users/profile",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "users",
                                "profile"
                            ]
                        },
                        "description": "Update the authenticated user's profile"
                    }
                },
                {
                    "name": "Logout User",
                    "request": {
                        "method": "POST",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/users/logout",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "users",
                                "logout"
                            ]
                        },
                        "description": "Logout the authenticated user"
                    }
                }
            ]
        },
        {
            "name": "Product Service",
            "item": [
                {
                    "name": "Get All Products",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/products/?page=1&limit=10",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "products",
                                ""
                            ],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "1"
                                },
                                {
                                    "key": "limit",
                                    "value": "10"
                                }
                            ]
                        },
                        "description": "Get a paginated list of all products"
                    }
                },
                {
                    "name": "Get Product by ID",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/products/{{PRODUCT_ID}}",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "products",
                                "{{PRODUCT_ID}}"
                            ]
                        },
                        "description": "Get detailed information about a specific product"
                    }
                },
                {
                    "name": "Search Products",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/products/search?q=laptop",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "products",
                                "search"
                            ],
                            "query": [
                                {
                                    "key": "q",
                                    "value": "laptop"
                                }
                            ]
                        },
                        "description": "Search products using full-text search"
                    }
                },
                {
                    "name": "Filter Products by Category",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/products/?category=electronics&min_price=100&max_price=1000",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "products",
                                ""
                            ],
                            "query": [
                                {
                                    "key": "category",
                                    "value": "electronics"
                                },
                                {
                                    "key": "min_price",
                                    "value": "100"
                                },
                                {
                                    "key": "max_price",
                                    "value": "1000"
                                }
                            ]
                        },
                        "description": "Filter products by category and price range"
                    }
                },
                {
                    "name": "Get Categories",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/categories/",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "categories",
                                ""
                            ]
                        },
                        "description": "Get all available product categories"
                    }
                },
                {
                    "name": "Create Product (Admin)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"name\": \"New Product\",\n  \"description\": \"Product description\",\n  \"price\": 99.99,\n  \"category\": \"electronics\",\n  \"stock\": 100,\n  \"image_url\": \"https://example.com/image.jpg\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/api/products/",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "products",
                                ""
                            ]
                        },
                        "description": "Create a new product (requires admin authentication)"
                    }
                },
                {
                    "name": "Update Product (Admin)",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"name\": \"Updated Product Name\",\n  \"price\": 89.99,\n  \"stock\": 150\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/api/products/{{PRODUCT_ID}}",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "products",
                                "{{PRODUCT_ID}}"
                            ]
                        },
                        "description": "Update an existing product (requires admin authentication)"
                    }
                },
                {
                    "name": "Delete Product (Admin)",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/products/{{PRODUCT_ID}}",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "products",
                                "{{PRODUCT_ID}}"
                            ]
                        },
                        "description": "Delete a product (requires admin authentication)"
                    }
                }
            ]
        },
        {
            "name": "Order Service",
            "item": [
                {
                    "name": "Create Order",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200 || pm.response.code === 201) {",
                                    "    const jsonData = pm.response.json();",
                                    "    if (jsonData.id) {",
                                    "        pm.environment.set('ORDER_ID', jsonData.id);",
                                    "        console.log('Order ID saved:', jsonData.id);",
                                    "    }",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"userUid\": \"{{USER_ID}}\",\n  \"shippingAddress\": \"123 Main St, New York, NY 10001, USA\",\n  \"items\": [\n    {\n      \"productId\": 1,\n      \"productName\": \"Laptop Dell XPS 15\",\n      \"quantity\": 2,\n      \"unitPrice\": 1299.99\n    },\n    {\n      \"productId\": 5,\n      \"productName\": \"Wireless Mouse\",\n      \"quantity\": 1,\n      \"unitPrice\": 29.99\n    }\n  ]\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/api/orders",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "orders"
                            ]
                        },
                        "description": "Create a new order with items"
                    }
                },
                {
                    "name": "Get Order by ID",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/orders/{{ORDER_ID}}",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "orders",
                                "{{ORDER_ID}}"
                            ]
                        },
                        "description": "Get detailed information about a specific order"
                    }
                },
                {
                    "name": "Get User Orders",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/orders",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "orders"
                            ]
                        },
                        "description": "Get all orders for the authenticated user"
                    }
                },
                {
                    "name": "Update Order Status",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"status\": \"PROCESSING\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/api/orders/{{ORDER_ID}}/status",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "orders",
                                "{{ORDER_ID}}",
                                "status"
                            ]
                        },
                        "description": "Update the status of an order"
                    }
                }
            ]
        },
        {
            "name": "Payment Service",
            "item": [
                {
                    "name": "Create Payment Intent",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"orderId\": \"{{ORDER_ID}}\",\n  \"amount\": 649.97,\n  \"currency\": \"usd\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/api/payments/create-intent",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "payments",
                                "create-intent"
                            ]
                        },
                        "description": "Create a payment intent for an order"
                    }
                },
                {
                    "name": "Confirm Payment",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"paymentIntentId\": \"pi_xxx\",\n  \"paymentMethodId\": \"pm_xxx\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/api/payments/confirm",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "payments",
                                "confirm"
                            ]
                        },
                        "description": "Confirm a payment with Stripe"
                    }
                },
                {
                    "name": "Get Payment Status",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/payments/:payment_id",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "payments",
                                ":payment_id"
                            ],
                            "variable": [
                                {
                                    "key": "payment_id",
                                    "value": "pi_xxx"
                                }
                            ]
                        },
                        "description": "Get the status of a payment"
                    }
                },
                {
                    "name": "Refund Payment (Admin)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"paymentIntentId\": \"pi_xxx\",\n  \"amount\": 649.97,\n  \"reason\": \"requested_by_customer\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/api/payments/refund",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "payments",
                                "refund"
                            ]
                        },
                        "description": "Refund a payment (requires admin authentication)"
                    }
                }
            ]
        },
        {
            "name": "Complete User Flow",
            "item": [
                {
                    "name": "1. Register New User",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200 || pm.response.code === 201) {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.environment.set('FIREBASE_ID_TOKEN', jsonData.idToken);",
                                    "    pm.environment.set('USER_ID', jsonData.uid);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"customer@example.com\",\n  \"password\": \"SecurePass123!\",\n  \"displayName\": \"John Doe\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/api/users/register",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "users",
                                "register"
                            ]
                        }
                    }
                },
                {
                    "name": "2. Browse Products",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/products?page=1&limit=10",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "products"
                            ],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "1"
                                },
                                {
                                    "key": "limit",
                                    "value": "10"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "3. Search for Product",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/products/search?q=laptop",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "products",
                                "search"
                            ],
                            "query": [
                                {
                                    "key": "q",
                                    "value": "laptop"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "4. Get Product Details",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/products/1",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "products",
                                "1"
                            ]
                        }
                    }
                },
                {
                    "name": "5. Create Order",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200 || pm.response.code === 201) {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.environment.set('ORDER_ID', jsonData.orderId);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"items\": [\n    {\n      \"productId\": 1,\n      \"quantity\": 1,\n      \"price\": 299.99\n    }\n  ],\n  \"shippingAddress\": {\n    \"street\": \"123 Test St\",\n    \"city\": \"Test City\",\n    \"state\": \"TS\",\n    \"zipCode\": \"12345\",\n    \"country\": \"USA\"\n  }\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/api/orders",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "orders"
                            ]
                        }
                    }
                },
                {
                    "name": "6. Create Payment Intent",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"orderId\": \"{{ORDER_ID}}\",\n  \"amount\": 299.99,\n  \"currency\": \"usd\"\n}"
                        },
                        "url": {
                            "raw": "{{BASE_URL}}/api/payments/create-intent",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "payments",
                                "create-intent"
                            ]
                        }
                    }
                },
                {
                    "name": "7. Get Order Status",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/orders/{{ORDER_ID}}",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "orders",
                                "{{ORDER_ID}}"
                            ]
                        }
                    }
                },
                {
                    "name": "8. Get User Profile",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{BASE_URL}}/api/users/profile",
                            "host": [
                                "{{BASE_URL}}"
                            ],
                            "path": [
                                "api",
                                "users",
                                "profile"
                            ]
                        }
                    }
                }
            ]
        }
    ]
}